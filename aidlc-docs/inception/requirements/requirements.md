# 테이블오더 서비스 요구사항 분석

## Intent Analysis Summary

### User Request
테이블오더 서비스 구축 - 고객이 테이블에서 직접 주문하고, 매장 운영자가 실시간으로 주문을 관리할 수 있는 디지털 주문 시스템

### Request Type
**New Project** - Greenfield 프로젝트

### Scope Estimate
**System-wide** - 고객용 인터페이스, 관리자용 인터페이스, 서버 시스템, 데이터베이스를 포함하는 전체 시스템

### Complexity Estimate
**Complex** - 실시간 주문 처리, 세션 관리, 다중 사용자 인터페이스, SSE 기반 실시간 통신 등 다양한 기술적 고려사항 포함

---

## 1. 프로젝트 개요

### 1.1 서비스 비전
디지털 주문 시스템을 통해 고객에게는 편리한 주문 경험을, 매장 운영자에게는 효율적인 운영 환경을 제공하는 차세대 테이블오더 플랫폼

### 1.2 핵심 가치 제안

**고객 관점**
- 대기 시간 없는 즉시 주문
- 직관적이고 사용하기 쉬운 인터페이스

**매장 운영자 관점**
- 인건비 절감 및 운영 효율성 증대
- 실시간 주문 관리 및 모니터링

---

## 2. 시스템 구성 요소

### 2.1 주요 컴포넌트
1. **고객용 웹 인터페이스** (Customer Web UI)
   - 브라우저 기반 웹 애플리케이션
   - 테이블 태블릿에서 실행
   - 자동 로그인 및 세션 관리

2. **관리자용 웹 인터페이스** (Admin Web UI)
   - 매장 운영자용 대시보드
   - 실시간 주문 모니터링
   - 테이블 및 메뉴 관리

3. **백엔드 서버** (Backend Server)
   - RESTful API 제공
   - 비즈니스 로직 처리
   - 실시간 통신 (SSE)

4. **데이터베이스** (Database)
   - 매장, 메뉴, 주문, 테이블 정보 저장
   - 관계형 데이터베이스

---

## 3. 기능 요구사항 (Functional Requirements)

### 3.1 고객용 기능

#### FR-C1: 테이블 태블릿 자동 로그인
- **설명**: 테이블 태블릿이 자동으로 로그인하여 고객이 즉시 주문 가능
- **세부 요구사항**:
  - 관리자가 1회 초기 설정 (매장 ID, 테이블 번호, 테이블 비밀번호)
  - 로그인 정보 로컬 저장
  - 이후 자동 로그인
  - 16시간 세션 유지

#### FR-C2: 메뉴 조회 및 탐색
- **설명**: 고객이 매장 메뉴를 카테고리별로 탐색
- **세부 요구사항**:
  - 메뉴 화면이 기본 화면
  - 카테고리별 메뉴 분류
  - 메뉴 상세 정보 표시 (이름, 가격, 설명, 이미지)
  - 카드 형태 레이아웃
  - 터치 친화적 UI (최소 44x44px 버튼)

#### FR-C3: 장바구니 관리
- **설명**: 주문 전 선택한 메뉴를 임시 저장 및 수정
- **세부 요구사항**:
  - 메뉴 추가/삭제
  - 수량 조절 (증가/감소)
  - 총 금액 실시간 계산
  - 장바구니 비우기
  - 로컬 저장 (페이지 새로고침 시에도 유지)
  - 서버 전송은 주문 확정 시에만

#### FR-C4: 주문 생성
- **설명**: 장바구니 메뉴를 실제 주문으로 전환
- **세부 요구사항**:
  - 주문 내역 최종 확인
  - 주문 확정 버튼
  - 주문 성공 시:
    - 주문 번호 표시
    - 장바구니 자동 비우기
    - 메뉴 화면으로 자동 리다이렉트
  - 주문 실패 시 에러 메시지 표시 및 장바구니 유지
  - 주문 정보 포함: 매장 ID, 테이블 ID, 메뉴 목록, 총 금액, 세션 ID

#### FR-C5: 주문 내역 조회
- **설명**: 현재 테이블의 주문 이력 확인
- **세부 요구사항**:
  - 주문 시간 순 정렬
  - 주문별 상세 정보 (주문 번호, 시각, 메뉴, 수량, 금액, 상태)
  - 주문 상태 실시간 업데이트 (SSE 기반)
  - 주문 상태 표시 (대기중/준비중/완료/취소)
  - 현재 테이블 세션 주문만 표시 (이전 세션 제외)
  - 매장 이용 완료 처리된 주문 제외

### 3.2 관리자용 기능

#### FR-A1: 매장 인증
- **설명**: 관리자가 매장 관리 시스템에 접근
- **세부 요구사항**:
  - 매장 식별자, 사용자명, 비밀번호 입력
  - 16시간 세션 유지
  - JWT 토큰 기반 인증
  - 브라우저 새로고침 시 세션 유지
  - 16시간 후 자동 로그아웃
  - 비밀번호 bcrypt 해싱
  - 로그인 시도 제한

#### FR-A2: 실시간 주문 모니터링
- **설명**: 들어오는 주문을 실시간으로 확인 및 관리
- **세부 요구사항**:
  - Server-Sent Events (SSE) 기반 실시간 업데이트
  - 그리드/대시보드 레이아웃
  - 테이블별 카드 형태 표시
  - 각 테이블 카드에 총 주문액 표시
  - 최신 주문 3개 미리보기 (더 많은 주문이 있으면 "더보기" 표시)
  - 주문 카드 클릭 시 전체 메뉴 목록 상세 보기
  - 주문 상태 변경 (대기중/준비중/완료/취소)
  - 신규 주문 시각적 강조 (색상, 애니메이션)
  - 2초 이내 주문 표시
  - 테이블별 필터링

#### FR-A3: 테이블 관리
- **설명**: 테이블별 주문 상태 관리 및 세션 라이프사이클 관리
- **세부 요구사항**:
  - **테이블 태블릿 초기 설정**: 테이블 번호 및 비밀번호 설정, 16시간 세션 생성
  - **주문 삭제**: 특정 주문 삭제, 확인 팝업, 총 주문액 재계산
  - **테이블 세션 처리**:
    - 세션 시작 (첫 주문) 및 종료 (이용 완료) 관리
    - 확인 팝업
    - 세션 종료 시 주문 내역을 과거 이력으로 이동
    - 세션 종료 시 현재 주문 목록 및 총 주문액 0으로 리셋
  - **과거 주문 내역 조회**:
    - 테이블별 과거 주문 목록 (시간 역순)
    - 주문 정보: 주문 번호, 시각, 메뉴 목록, 총 금액, 완료 시각
    - 날짜 필터링

#### FR-A4: 메뉴 관리
- **설명**: 메뉴 정보를 동적으로 관리
- **세부 요구사항**:
  - 메뉴 조회 (카테고리별)
  - 메뉴 등록 (메뉴명, 가격, 설명, 카테고리, 이미지 파일)
  - 이미지 업로드 제약: JPG/PNG 형식, 최대 5MB
  - 이미지 업로드 진행률 표시
  - 메뉴 수정
  - 메뉴 삭제
  - 메뉴 노출 순서 조정
  - 필수 필드 검증
  - 가격 범위 검증

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

### NFR-1: 성능 (Performance)
- **실시간 주문 업데이트**: 2초 이내 관리자 화면에 표시
- **페이지 로딩 시간**: 3초 이내
- **동시 사용자**: 테이블당 1개 세션, 매장당 최대 50개 테이블 지원

### NFR-2: 보안 (Security)
- **인증**: JWT 토큰 기반
- **비밀번호**: bcrypt 해싱
- **세션 관리**: 16시간 자동 만료
- **로그인 시도 제한**: 5회 실패 시 일시 잠금

### NFR-3: 사용성 (Usability)
- **터치 친화적 UI**: 최소 44x44px 버튼 크기
- **직관적 네비게이션**: 3클릭 이내 모든 기능 접근
- **반응형 디자인**: 태블릿 화면 최적화

### NFR-4: 신뢰성 (Reliability)
- **데이터 지속성**: 장바구니 로컬 저장 (새로고침 시에도 유지)
- **에러 처리**: 명확한 에러 메시지 표시
- **주문 무결성**: 주문 생성 실패 시 장바구니 유지

### NFR-5: 확장성 (Scalability)
- **다양한 업종 적용**: 유연한 메뉴 카테고리 구조
- **매장 확장**: 다중 매장 지원 가능한 구조

### NFR-6: 유지보수성 (Maintainability)
- **코드 구조**: 모듈화된 컴포넌트 구조
- **문서화**: API 문서 및 코드 주석

---

## 5. 데이터 요구사항

### 5.1 주요 엔티티
1. **Store (매장)**
   - 매장 식별자, 매장명, 관리자 정보

2. **Table (테이블)**
   - 테이블 번호, 테이블 PIN (4자리), 세션 ID, 세션 상태

3. **Menu (메뉴)**
   - 메뉴명, 가격, 설명, 카테고리, 이미지 파일 경로, 노출 순서

4. **Order (주문)**
   - 주문 번호, 테이블 ID, 주문 시각, 총 금액, 상태 (대기중/준비중/완료/취소), 세션 ID

5. **OrderItem (주문 항목)**
   - 주문 ID, 메뉴 ID, 수량, 단가

6. **OrderHistory (주문 이력)**
   - 완료된 주문 정보, 완료 시각, 1년간 보관

---

## 6. 제외 기능 (Out of Scope)

다음 기능들은 MVP 범위에서 제외:
- 결제 처리 (카드, 현금, PG 연동)
- 영수증 발행
- 포인트/쿠폰 시스템
- 푸시 알림, SMS, 이메일
- 주방 디스플레이 시스템
- 재고 관리
- 직원 관리
- 예약 시스템
- 고객 리뷰
- 외부 플랫폼 연동

---

## 7. MVP 범위

### 필수 기능 (Must Have)
- 테이블 태블릿 자동 로그인 및 세션 관리 (4자리 PIN)
- 메뉴 조회 및 장바구니 관리
- 주문 생성 및 내역 조회
- **주문 상태 실시간 업데이트** (고객 화면, SSE 기반)
- 매장 인증 (16시간 세션)
- 실시간 주문 모니터링 (SSE)
- 테이블 관리 (초기 설정, 주문 삭제/취소, 세션 종료, 과거 내역)
- **메뉴 관리** (등록/수정/삭제, 이미지 업로드)
- **다중 매장 지원** (중앙 관리 시스템)

### 선택 기능 (Nice to Have)
- 날짜별 과거 내역 필터링
- 고급 통계 및 리포트

---

## 8. 기술적 고려사항

### 8.1 기술 스택 (검증 완료)
- **백엔드**: Java (Spring Boot)
- **프론트엔드**: React
- **데이터베이스**: In-Memory Database (H2 또는 유사)
- **배포 환경**: 로컬 서버 (On-premises)
- **API 문서화**: Swagger/OpenAPI
- **테스트**: Unit 테스트 + Integration 테스트

### 8.2 실시간 통신
- Server-Sent Events (SSE) 사용
- 관리자 화면에서 주문 실시간 수신
- **고객 화면에서도 주문 상태 실시간 업데이트** (필수 기능)

### 8.3 세션 관리
- 테이블 세션: 첫 주문부터 이용 완료까지
- 관리자 세션: 16시간 JWT 토큰
- 테이블 태블릿 세션: 16시간 자동 로그인
- **테이블 인증**: 4자리 PIN 방식

### 8.4 데이터 저장
- 장바구니: 클라이언트 로컬 저장 (localStorage)
- 주문: 서버 In-Memory 데이터베이스 저장
- 세션 정보: 서버 및 클라이언트 양측 관리
- **메뉴 이미지**: 서버에 파일 업로드 및 저장
- **과거 주문 내역**: 1년간 보관

### 8.5 다중 매장 지원
- **중앙 관리 시스템**: 여러 매장을 중앙에서 관리
- 매장당 최대 10개 테이블 지원
- 매장별 독립적인 메뉴 및 주문 관리

### 8.6 주문 상태 관리
- 기본 상태: 대기중, 준비중, 완료
- **추가 상태**: 취소 (관리자가 주문 취소 가능)
- 관리자는 모든 상태의 주문 삭제 가능

### 8.7 로깅 및 모니터링
- 개발 환경: 콘솔 로그만 사용
- 에러 처리: 명확한 에러 메시지 표시

---

## 부록: 용어 정의

- **테이블 세션**: 특정 테이블에 고객이 앉아서 첫 주문 시작 후부터 해당 테이블 이용 완료 처리까지의 시간. 세션 종료 후 다른 고객의 첫 주문 시작 시, 새로운 세션 시작.
- **SSE (Server-Sent Events)**: 서버에서 클라이언트로 실시간 데이터를 푸시하는 기술
- **JWT (JSON Web Token)**: 인증 정보를 안전하게 전달하기 위한 토큰 기반 인증 방식
- **MVP (Minimum Viable Product)**: 최소 기능 제품
