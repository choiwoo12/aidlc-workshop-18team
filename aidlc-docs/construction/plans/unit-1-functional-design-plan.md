# Functional Design Plan - Unit 1: Shared Foundation

## Overview

**Unit**: Unit 1 - Shared Foundation  
**Purpose**: 공통 인프라, 엔티티, 유틸리티 제공  
**Bounded Context**: Infrastructure & Shared Domain

**Assigned Stories**:
- US-A-001: 관리자 로그인 (3 points)
- US-NFR-002: 보안 요구사항 (5 points)

---

## Functional Design Scope

이 계획은 Unit 1의 비즈니스 로직과 도메인 모델을 설계합니다:
- 도메인 엔티티의 속성, 관계, 비즈니스 규칙
- 관리자 인증 비즈니스 로직
- 데이터 유효성 검증 규칙
- 엔티티 간 관계 및 제약사항

**기술 스택 독립적**: 이 단계에서는 Python, React, SQLite 등 구체적인 기술은 고려하지 않습니다.

---

## Execution Steps

### Step 1: Domain Entity Analysis
[x] 도메인 엔티티 6개 분석 (Store, Table, Menu, Order, OrderItem, OrderHistory)
[x] 각 엔티티의 속성 정의
[x] 엔티티 간 관계 정의 (1:N, N:M 등)
[x] 비즈니스 제약사항 식별

### Step 2: Business Rules Definition
[x] 관리자 인증 비즈니스 규칙 정의
[x] 테이블 자동 로그인 비즈니스 규칙 정의
[x] 데이터 유효성 검증 규칙 정의
[x] 보안 관련 비즈니스 규칙 정의

### Step 3: Data Validation Logic
[x] 엔티티별 필수 필드 정의
[x] 데이터 타입 및 형식 제약사항 정의
[x] 비즈니스 규칙 기반 유효성 검증 로직 정의

### Step 4: Authentication Business Logic
[x] 관리자 로그인 프로세스 정의
[x] 테이블 자동 로그인 프로세스 정의
[x] 인증 토큰 생명주기 정의
[x] 세션 관리 규칙 정의

### Step 5: File Storage Business Logic
[x] 이미지 업로드 비즈니스 규칙 정의
[x] 파일 저장 및 조회 프로세스 정의
[x] 파일 삭제 규칙 정의

---

## Clarification Questions

다음 질문들에 답변하여 Functional Design의 방향을 결정해주세요.

### Q1: Store Entity - 매장 정보 범위
매장(Store) 엔티티에 어떤 정보를 포함해야 할까요?

A) 기본 정보만 (매장명, 관리자 계정)
B) 기본 + 운영 정보 (영업시간, 연락처)
C) 기본 + 운영 + 설정 (테마, 언어)
D) 전체 정보 (기본 + 운영 + 설정 + 통계)
E) Other (설명해주세요)

[Answer]: A

**Rationale**: 매장 엔티티의 범위는 시스템 복잡도와 확장성에 영향을 미칩니다.

---

### Q2: Table Entity - 테이블 상태 관리
테이블의 상태를 어떻게 관리해야 할까요?

A) 단순 상태 (사용중/비어있음)
B) 상세 상태 (비어있음/사용중/정리중/예약됨)
C) 상태 + 타임스탬프 (상태 변경 시간 추적)
D) 상태 + 타임스탬프 + 이력 (모든 상태 변경 기록)
E) Other (설명해주세요)

[Answer]: D

**Rationale**: 테이블 상태 관리 방식은 테이블 관리 기능의 복잡도를 결정합니다.

---

### Q3: Menu Entity - 메뉴 카테고리 구조
메뉴 카테고리를 어떻게 구조화해야 할까요?

A) 단일 레벨 카테고리 (예: 메인, 사이드, 음료)
B) 2단계 카테고리 (예: 음료 > 커피/주스)
C) 다단계 카테고리 (무제한 depth)
D) 태그 기반 분류 (카테고리 + 태그)
E) Other (설명해주세요)

[Answer]: B

**Rationale**: 카테고리 구조는 메뉴 조회 및 관리 UI의 복잡도에 영향을 미칩니다.

---

### Q4: Menu Entity - 메뉴 옵션 관리
메뉴 옵션(예: 사이즈, 토핑)을 어떻게 관리해야 할까요?

A) 옵션 없음 (기본 메뉴만)
B) 간단한 옵션 (텍스트 필드로 메모)
C) 구조화된 옵션 (옵션 그룹 + 선택지 + 가격)
D) 복잡한 옵션 (필수/선택, 다중선택, 가격 변동)
E) Other (설명해주세요)

[Answer]: D

**Rationale**: 메뉴 옵션 복잡도는 주문 생성 로직과 UI에 큰 영향을 미칩니다.

---

### Q5: Order Entity - 주문 상태 전이
주문 상태 전이를 어떻게 정의해야 할까요?

A) 단순 전이 (대기중 → 완료)
B) 표준 전이 (대기중 → 준비중 → 완료)
C) 상세 전이 (대기중 → 확인됨 → 준비중 → 서빙 대기 → 완료)
D) 유연한 전이 (관리자가 임의 상태로 변경 가능)
E) Other (설명해주세요)

[Answer]: C

**Rationale**: 주문 상태 전이 규칙은 주문 관리 비즈니스 로직의 핵심입니다.

---

### Q6: Order Entity - 주문 수정 정책
주문 생성 후 수정을 어떻게 처리해야 할까요?

A) 수정 불가 (삭제 후 재생성만 가능)
B) 상태별 수정 가능 (대기중일 때만 수정 가능)
C) 항목 추가만 가능 (기존 항목 수정 불가)
D) 전체 수정 가능 (모든 상태에서 수정 가능)
E) Other (설명해주세요)

[Answer]: B

**Rationale**: 주문 수정 정책은 데이터 무결성과 사용자 경험에 영향을 미칩니다.

---

### Q7: OrderHistory Entity - 이력 저장 범위
주문 이력에 어떤 정보를 저장해야 할까요?

A) 최소 정보 (주문 ID, 테이블, 총액, 날짜)
B) 기본 정보 (최소 + 주문 항목 스냅샷)
C) 상세 정보 (기본 + 상태 변경 이력)
D) 전체 정보 (상세 + 삭제된 항목 + 수정 이력)
E) Other (설명해주세요)

[Answer]: C

**Rationale**: 이력 저장 범위는 데이터베이스 크기와 분석 가능성에 영향을 미칩니다.

---

### Q8: Admin Authentication - 비밀번호 정책
관리자 비밀번호 정책을 어떻게 정의해야 할까요?

A) 최소 정책 (최소 길이만)
B) 기본 정책 (길이 + 문자 종류)
C) 강력한 정책 (길이 + 문자 종류 + 특수문자 + 숫자)
D) 매우 강력한 정책 (강력한 정책 + 만료 기간 + 재사용 제한)
E) Other (설명해주세요)

[Answer]: C

**Rationale**: 비밀번호 정책은 보안 수준과 사용자 편의성의 균형을 결정합니다.

---

### Q9: Table Auto-Login - 테이블 식별 방법
테이블 자동 로그인 시 테이블을 어떻게 식별해야 할까요?

A) 테이블 번호만 (숫자)
B) 테이블 코드 (영숫자 조합)
C) QR 코드 (고유 토큰)
D) NFC 태그 (물리적 태그)
E) Other (설명해주세요)

[Answer]: A

**Rationale**: 테이블 식별 방법은 사용자 경험과 보안에 영향을 미칩니다.

---

### Q10: File Storage - 이미지 파일 제약사항
메뉴 이미지 업로드 시 어떤 제약사항을 적용해야 할까요?

A) 최소 제약 (파일 크기만)
B) 기본 제약 (크기 + 파일 형식)
C) 상세 제약 (크기 + 형식 + 해상도)
D) 엄격한 제약 (상세 + 파일명 규칙 + 바이러스 검사)
E) Other (설명해주세요)

[Answer]: A

**Rationale**: 파일 제약사항은 보안, 성능, 저장 공간에 영향을 미칩니다.

---

### Q11: Entity Relationships - 주문과 메뉴 관계
주문 항목(OrderItem)이 메뉴(Menu)를 참조하는 방식은?

A) 직접 참조 (Menu ID만 저장)
B) 스냅샷 (주문 시점의 메뉴 정보 복사)
C) 하이브리드 (Menu ID + 주문 시점 가격/이름)
D) 완전 분리 (Menu와 독립적인 OrderItem)
E) Other (설명해주세요)

[Answer]: A

**Rationale**: 메뉴 변경 시 과거 주문 데이터의 정확성에 영향을 미칩니다.

---

### Q12: Data Validation - 유효성 검증 시점
데이터 유효성 검증을 언제 수행해야 할까요?

A) 클라이언트만 (프론트엔드)
B) 서버만 (백엔드)
C) 양쪽 모두 (프론트엔드 + 백엔드)
D) 다층 검증 (프론트엔드 + 백엔드 + 데이터베이스)
E) Other (설명해주세요)

[Answer]: A

**Rationale**: 검증 시점은 보안, 사용자 경험, 개발 복잡도에 영향을 미칩니다.

---

### Q13: Business Rules - 동시성 제어
여러 관리자가 동시에 같은 주문을 수정하려 할 때 어떻게 처리해야 할까요?

A) 제어 없음 (마지막 수정이 적용됨)
B) 낙관적 잠금 (버전 번호로 충돌 감지)
C) 비관적 잠금 (수정 중 다른 사용자 차단)
D) 충돌 해결 UI (사용자가 선택)
E) Other (설명해주세요)

[Answer]: C

**Rationale**: 동시성 제어는 데이터 무결성과 사용자 경험에 영향을 미칩니다.

---

### Q14: Business Rules - 주문 삭제 정책
주문 삭제를 어떻게 처리해야 할까요?

A) 물리적 삭제 (데이터베이스에서 완전 삭제)
B) 논리적 삭제 (deleted 플래그 설정)
C) 이력 보관 (OrderHistory로 이동 후 삭제)
D) 삭제 불가 (취소 상태로만 변경)
E) Other (설명해주세요)

[Answer]: C

**Rationale**: 삭제 정책은 데이터 복구 가능성과 감사 추적에 영향을 미칩니다.

---

### Q15: Business Rules - 테이블 세션 종료 시 처리
테이블 세션 종료 시 미완료 주문이 있으면 어떻게 처리해야 할까요?

A) 강제 종료 (모든 주문 자동 완료)
B) 경고 후 종료 (관리자 확인 필요)
C) 종료 불가 (모든 주문 완료 후에만 가능)
D) 선택적 처리 (관리자가 주문별로 결정)
E) Other (설명해주세요)

[Answer]: D

**Rationale**: 세션 종료 정책은 데이터 무결성과 운영 유연성에 영향을 미칩니다.

---

## Next Steps

1. 모든 질문에 [Answer]: 태그로 답변해주세요
2. 답변 완료 후 "완료했습니다"라고 알려주세요
3. AI가 답변을 분석하고 모호한 부분이 있으면 추가 질문을 드립니다
4. 모든 답변이 명확해지면 Functional Design 아티팩트를 생성합니다

---

**문서 버전**: 1.0  
**작성일**: 2026-02-09  
**상태**: 질문 대기중
